let uuidv4,dbPromise;_ff3‍.x([["grantAuthToken",()=>grantAuthToken],["searchUserFromAuthToken",()=>searchUserFromAuthToken]]);_ff3‍.w("uuid",[["v4",["uuidv4"],function(v){uuidv4=v}]]);_ff3‍.w("./index",[["dbPromise",["dbPromise"],function(v){dbPromise=v}]]);/* 
Author: Unique Ratliff
Date: 11/26/2020
Description: An interactive message board that allows for user
    account functionality
 */





//Takes a user and returns a token
       const grantAuthToken = async (userId) => {
    const db = await _ff3‍.a("dbPromise",dbPromise);
    const tokenString = _ff3‍.a("uuidv4",uuidv4)();
    await db.run('INSERT INTO AuthTokens (token, userId) VALUES (?, ?);',
    tokenString, userId);

    return tokenString;
};_ff3‍.j(["grantAuthToken"]);

//Takes a token and returns a user
       const searchUserFromAuthToken = async (authToken) => {
    const db = await _ff3‍.a("dbPromise",dbPromise);
    const token = await db.get('SELECT * FROM AuthTokens WHERE token=?;', authToken);
    if(!token) {
        return null;
    }
    const user = await db.get('SELECT id, email, username FROM Users WHERE id=?', token.userId);

    return user;
};_ff3‍.j(["searchUserFromAuthToken"]);